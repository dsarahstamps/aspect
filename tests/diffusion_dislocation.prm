set Dimension = 2

subsection Geometry model
  set Model name = box

  subsection Box
    set X extent    = 3000e3
    set Y extent    = 750e3
  end
end

subsection Model settings
  set Fixed temperature boundary indicators   = 2, 3
  set Tangential velocity boundary indicators = 0, 1, 2, 3
end

subsection Compositional fields
  set Number of fields = 2
  set Names of fields  = upper_crust, lower_crust
end

subsection Compositional initial conditions
  set Model name = function

  subsection Function
    set Variable names = x,y
    set Function expression = if(y>=725e3,1,0);if((y<725e3&y>700e3),1,0)
  end
end

subsection Initial conditions
  set Model name = function

  subsection Function
    set Variable names = x,y
    set Function constants = h=750e3, w=3000e3
    set Function expression = \
      if( y < 100e3, \
        (100e3-y)/100e3*100+1635, \
        if(y>650e3, \
          (h-y)/(100e3)*1342+293, \
          1635))
  end
end

subsection Material model
  set Model name = diffusion dislocation

  subsection DiffusionDislocation
    set Reference temperature = 293
    set Minimum strain rate = 5e-19
    set Minimum viscosity = 1e17
    set Maximum viscosity = 1e28
    set Effective viscosity coefficient = 1.0
    set Reference viscosity = 1e22

    set Thermal diffusivity = 0.8e-6
    set Heat capacity = 1.25e3

    set Densities = 3300,2700,2700
    set Thermal expansivities = 2e-5

    set Viscosity averaging scheme = harmonic

    set Prefactors for diffusion creep = 1.92e-11
    set Activation energies for diffusion creep = 5e5,3.2e5,3.2e5
    set Activation volumes for diffusion creep = 6.4e-6

    set Prefactors for dislocation creep = 2.42e-10
    set Activation energies for dislocation creep = 5.4e5
    set Activation volumes for dislocation creep = 6.4e-6
    set Stress exponents for dislocation creep = 3
  end
end

subsection Boundary temperature model
  set Model name = initial temperature
end

subsection Boundary composition model
  set Model name = initial composition
end

subsection Gravity model
  set Model name = vertical

  subsection Vertical
    set Magnitude = 9.81
  end
end

subsection Mesh refinement
  set Initial global refinement                 = 5
  set Initial adaptive refinement               = 0
end

subsection Termination criteria
  set Termination criteria = end step
  set End step = 0
end
